# GMatch 常见问题解答 (FAQ)

## 基础问题

### Q: GMatch是什么？
**A:** GMatch是一个用C++17实现的高性能游戏匹配服务，它提供基于玩家评分的匹配算法，支持客户端-服务器架构，可以应用于各种游戏类型。

### Q: GMatch的主要功能有哪些？
**A:** GMatch的主要功能包括：
- 基于评分的玩家匹配
- 可配置的匹配参数
- 多线程匹配处理
- TCP服务器支持多客户端连接
- JSON格式的通信协议
- 完整的日志系统
- 配置文件支持

### Q: GMatch的系统要求是什么？
**A:** GMatch需要以下环境：
- C++17兼容的编译器（GCC 7+，Clang 5+）
- CMake 3.10+
- Linux/Unix系统（目前不支持Windows）
- pthread支持

## 安装与配置

### Q: 如何安装GMatch？
**A:** 使用以下命令安装GMatch：
```bash
# 克隆仓库
git clone https://github.com/yourusername/GMatch.git
cd GMatch

# 使用构建脚本构建
./scripts/build.sh

# 安装
./scripts/build.sh --install
```

### Q: 如何配置GMatch服务器？
**A:** GMatch通过配置文件`config.ini`进行配置。主要配置项包括：
- 服务器地址和端口
- 每房间玩家数和最大评分差异
- 日志级别和输出文件
- 线程池大小等

详细配置请参考`config.ini.example`文件。

### Q: 如何运行GMatch服务器？
**A:** 使用以下命令运行服务器：
```bash
./scripts/run_server.sh
```
或者自定义参数：
```bash
./scripts/run_server.sh --port 8888 --log-level 0
```

### Q: 如何运行GMatch客户端？
**A:** 使用以下命令运行客户端：
```bash
./scripts/run_client.sh
```
或者自定义服务器地址和端口：
```bash
./scripts/run_client.sh --address 192.168.1.100 --port 8888
```

## 使用问题

### Q: 如何创建玩家？
**A:** 在客户端使用`create`命令创建玩家：
```
create Player1 1500
```
其中`Player1`是玩家名称，`1500`是初始评分。

### Q: 如何让玩家加入匹配队列？
**A:** 创建玩家后，使用`join`命令加入匹配队列：
```
join
```

### Q: 如何查看当前的房间列表？
**A:** 使用`rooms`命令查看当前所有房间：
```
rooms
```

### Q: 玩家匹配成功后会发生什么？
**A:** 匹配成功后，客户端会收到匹配成功通知，显示房间ID和匹配到的其他玩家信息。

### Q: 如何查看匹配队列的状态？
**A:** 使用`queue`命令查看当前匹配队列的状态：
```
queue
```

### Q: 如何让玩家离开匹配队列？
**A:** 使用`leave`命令让玩家离开匹配队列：
```
leave
```

## 技术问题

### Q: GMatch如何处理玩家评分差异？
**A:** GMatch通过配置文件中的`max_rating_diff`参数控制可接受的最大评分差异。匹配算法会尝试将评分接近的玩家匹配在一起，如果队列中找不到评分接近的玩家，玩家会在队列中等待。

### Q: 服务器可以同时处理多少个连接？
**A:** 默认情况下，GMatch可以处理高达10,000个并发连接，但实际连接数受系统文件描述符限制和硬件资源影响。可以通过配置文件中的`max_connections`参数调整。

### Q: GMatch使用什么通信协议？
**A:** GMatch使用TCP作为传输层协议，使用JSON作为消息格式。每个消息都是一个完整的JSON对象，以换行符结束。详细协议说明请参考`docs/API.md`。

### Q: 如何扩展GMatch以支持更多玩家？
**A:** 可以通过以下方式扩展GMatch：
1. 增加服务器硬件资源（CPU、内存）
2. 优化配置参数（线程池大小、缓冲区大小等）
3. 实现集群支持，使用多台服务器处理请求
4. 参考`docs/PERFORMANCE.md`中的性能优化建议

### Q: 如何添加新的匹配算法？
**A:** 可以通过扩展`MatchMaker`类实现新的匹配算法：
1. 创建`MatchMaker`的子类
2. 重写`matchPlayers`方法实现自定义匹配逻辑
3. 在`MatchManager`中使用新的匹配器实现

## 问题排查

### Q: 服务器启动失败，提示"地址已被使用"，如何解决？
**A:** 这表示所配置的端口已被其他程序占用。可以尝试以下解决方法：
1. 使用不同的端口：`./scripts/run_server.sh --port 8081`
2. 停止占用该端口的程序：`sudo lsof -i :8080` 然后 `kill <pid>`
3. 如果是刚刚关闭的服务器实例，可能是TCP处于TIME_WAIT状态，等待一段时间后再尝试

### Q: 客户端无法连接到服务器，如何排查？
**A:** 可以按以下步骤排查：
1. 确认服务器正在运行：`ps -ef | grep match_server`
2. 检查防火墙设置：`sudo iptables -L`
3. 尝试使用telnet测试连接：`telnet <server_ip> <port>`
4. 检查服务器日志文件：`cat match_server.log`

### Q: 玩家无法匹配成功，可能的原因是什么？
**A:** 玩家无法匹配可能有以下原因：
1. 队列中玩家太少，没有满足评分要求的其他玩家
2. 配置的`max_rating_diff`太小，限制了匹配范围
3. 配置的`players_per_room`大于队列中的玩家数
4. 匹配算法存在问题，检查服务器日志查看详细错误

### Q: 服务器性能不佳，如何优化？
**A:** 服务器性能优化可以参考以下方向：
1. 增加服务器硬件资源（CPU、内存）
2. 优化配置参数，如增加线程池大小、调整匹配间隔等
3. 使用性能分析工具如perf或Valgrind找出瓶颈
4. 查看`docs/PERFORMANCE.md`获取详细的性能优化指南

## 开发相关

### Q: 如何贡献代码给GMatch项目？
**A:** 请参考`CONTRIBUTING.md`文件，其中包含了代码贡献指南、代码风格规范和提交流程。

### Q: 如何编写新的测试用例？
**A:** 在`test`目录下创建新的测试文件，使用Google Test框架编写测试用例，然后更新`test/CMakeLists.txt`文件添加新的测试源文件。

### Q: 如何修改匹配算法？
**A:** 修改`src/core/MatchMaker.cpp`中的`matchPlayers`方法，实现自己的匹配逻辑。如果需要更复杂的修改，可以创建`MatchMaker`的子类实现完全自定义的匹配算法。

### Q: 项目的代码结构是怎样的？
**A:** 请参考`docs/CODE_MAP.md`文件，其中详细描述了项目的目录结构和主要类的关系。

## 其他问题

### Q: GMatch是开源的吗？可以用于商业项目吗？
**A:** GMatch采用MIT许可证，您可以自由使用、修改和分发，包括用于商业项目。详细许可信息请参考`LICENSE`文件。

### Q: 如何获取更多帮助？
**A:** 可以通过以下方式获取帮助：
1. 查阅`docs`目录下的文档
2. 提交GitHub Issues报告问题
3. 查看示例代码和测试用例
4. 联系项目维护者寻求支持

### Q: GMatch计划支持更多功能吗？
**A:** GMatch计划增加以下功能：
- 支持Windows平台
- 添加Web管理界面
- 支持更多匹配算法
- 实现比赛历史记录功能
- 添加数据持久化支持

详细的开发路线图请关注项目的GitHub页面。 